{
  "gitSyncId": "6694e79242e0cf1ce121987e_aed39efa-6aa9-4296-98ae-5104c7e965d5",
  "id": "HomePage_screen_point_right_chart",
  "pluginId": "mysql-plugin",
  "pluginType": "DB",
  "unpublishedAction": {
    "actionConfiguration": {
      "body": "SELECT\n\tCONCAT( SUBSTRING( t1.`month`, 3, 2 ), '年', SUBSTRING( t1.`month`, 6, 2 ), '月' ) AS \"x\",\n\tROUND ( IFNULL( IFNULL( t2.duration, 0 ) / IFNULL( t2.count, 0 ), 0 ), 2 ) AS \"y\" \nFROM\n\tsix_months t1\n\tLEFT JOIN (\n\t\tSELECT\n\t\tDATE_FORMAT( a.alarm_date, '%Y-%m' ) AS \"date\",\n\t\tCOUNT( CASE WHEN a.handle_status = 3 THEN 0 END ) + COUNT( CASE WHEN a.handle_status = 4 THEN 0 END ) AS \"count\",\n\t\tIFNULL(\n\t\t\tSUM(\n\t\t\t\tIF\n\t\t\t\t( a.handle_status = 4, ROUND( TIMESTAMPDIFF( HOUR, a.alarm_date, a.updatedate ), 2 ), 0 )),\n\t\t\t0.00 \n\t\t) + IFNULL(\n\t\t\tSUM(\n\t\t\t\tIF\n\t\t\t\t( a.handle_status = 3, ROUND( TIMESTAMPDIFF( HOUR, a.alarm_date, a.updatedate ), 2 ), 0 )),\n\t\t\t0.00 \n\t\t) AS \"duration\" \n\t\tFROM\n\t\tiot_algorithm_alarm a\n\t\tLEFT JOIN iot_device b ON a.device_id = b.id \n\t\tAND b.isdeleted = 0\n\t\tLEFT JOIN iot_product c ON b.product_id = c.id \n\t\tAND c.isdeleted = 0\n\t\tLEFT JOIN iot_product_link d ON d.product_id = c.id \n\t\tWHERE\n\t\ta.isdeleted = '0' \n\t\tAND a.parent_id = 0\n\t\tAND d.org_code LIKE concat(\"iot\", '%' )\n\t\tAND a.algorithm_id = {{this.params.algorithmId}}\n\t\tGROUP BY\n\t\tDATE_FORMAT( a.alarm_date, '%Y-%m' )) t2 ON t1.`month` = t2.date \nORDER BY\n\tt1.`month` ASC\n",
      "encodeParamsToggle": true,
      "paginationType": "NONE",
      "pluginSpecifiedTemplates": [
        {
          "value": true
        }
      ],
      "timeoutInMillisecond": 10000
    },
    "confirmBeforeExecute": false,
    "datasource": {
      "id": "superton-iot-platform",
      "isAutoGenerated": false,
      "name": "superton-iot-platform",
      "pluginId": "mysql-plugin"
    },
    "dynamicBindingPathList": [
      {
        "key": "body"
      }
    ],
    "executeOnLoad": true,
    "name": "screen_point_right_chart",
    "pageId": "HomePage",
    "userSetOnLoad": false
  }
}